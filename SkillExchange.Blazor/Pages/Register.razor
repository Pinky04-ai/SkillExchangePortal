@page "/register"
@using SkillExchange.Blazor.Models
@using SkillExchange.Blazor.Services
@inject AuthService Auth
@inject NavigationManager Nav
<h3 class="form-title">Register</h3>
<div class="form-container">
    <EditForm Model="@registerModel" OnValidSubmit="HandleRegister">
        <DataAnnotationsValidator />
        <ValidationSummary />
        <div class="form-group">
            <label>FirstName</label>
            <InputText @bind-Value="registerModel.FirstName" class="form-input" />
        </div>
        <div class="form-group">
            <label>LastName</label>
            <InputText @bind-Value="registerModel.LastName" class="form-input" />
        </div>
        <div class="form-group">
            <label>Email</label>
            <InputText @bind-Value="registerModel.Email" class="form-input" />
        </div>
        <div class="form-group">
            <label>Password</label>
            <InputText @bind-Value="registerModel.Password" type="password" class="form-input" />
        </div>
        <button type="submit" class="btn-primary">Register</button>
        @if (!string.IsNullOrEmpty(message))
        {
            <p class="status">@message</p>
        }
    </EditForm>
</div>
@code {
    private RegisterRequest registerModel = new();
    private string? message;
    private async Task HandleRegister()
    {
        var success = await Auth.RegisterAsync(registerModel);
        if (success)
        {
            message = " Your account is underverification . Admin must approve before you log in";
         
        }
        else
        {
            message = " Registration failed. Try again.";
        }
    }
}
